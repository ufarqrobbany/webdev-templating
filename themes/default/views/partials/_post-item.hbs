<div class="card post-item" data-post-id="{{this.id}}">
        {{#if (eq this.author.id @root.user.id)}}
          <button class="post-menu-btn js-post-menu-btn" data-post-id="{{this.id}}" aria-haspopup="true" aria-expanded="false" aria-label="Opsi postingan">
            <i class="fas fa-ellipsis-vertical" aria-hidden="true"></i>
          </button>
          <div class="post-menu js-post-menu" data-post-id="{{this.id}}" style="display:none;">
            <button type="button" class="post-menu-item danger js-post-delete" data-post-id="{{this.id}}">
              <i class="fas fa-trash-alt" aria-hidden="true"></i>
              Hapus postingan
            </button>
          </div>
        {{/if}}
        {{!-- ðŸ‘‡ BLOK KODE BARU DENGAN AVATAR & FLEX HORIZONTAL ðŸ‘‡ --}}
        <div class="post-author-row" style="display: flex; align-items: center; gap: 10px;">
          {{#if this.author}}
            {{!-- Profile Picture with Initials --}}
            <div class="avatar avatar-sm flex-shrink-0">
              {{slice this.author.firstName 0 1}}{{slice this.author.lastName 0 1}}
            </div>
            {{!-- Author Name and "Anda" Label --}}
            <div style="display: flex; align-items: center; gap: 8px;">
              {{!-- ðŸ‘‡ PERBAIKI STYLE INI AGAR FONT-WEIGHT TIDAK GANDA ðŸ‘‡ --}}
              <a href="/users/{{this.author.id}}/profile" style="color: inherit; text-decoration: none; font-weight: bold;"> 
                <span class="post-author-name">{{this.author.firstName}} {{this.author.lastName}}</span>
              </a>
              {{#if (eq this.author.id @root.user.id)}}
                <span style="background-image: var(--gradient-accent); color: #1f2937; padding: 2px 8px; border-radius: 9999px; font-size: 12px; font-weight: 600; margin-left: 2px;">Anda</span>
              {{/if}}
            </div>

            {{!-- Tombol Follow (MVP v1.4) --}}
            {{#if @root.user}} {{!-- Cek apakah user-nya login --}}
              {{#if this.author}}
                {{!-- Tampilkan tombol follow hanya jika post bukan milik user yg login --}}
                {{!-- Helper 'eq' perlu didaftarkan di backend --}}
                {{#unless (eq this.author.id @root.user.id)}}
                  {{!-- Tampilkan Follow hanya jika TIDAK mengikuti penulis (isNotFollowing) --}}
                  {{#unless isFollowing}}
                    <form action="/api/v1/users/{{this.author.id}}/follow" method="POST" style="margin-top: 0px; margin-left: 4px; display: inline-block;">
                      <button type="submit" class="btn-follow">+ Follow</button>
                    </form>
                  {{/unless}}
                {{/unless}}
              {{/if}}
            {{/if}}
          {{else}}
            <span class="post-author-name">User Anonim</span>
          {{/if}}
        </div>
        {{!-- ðŸ‘† AKHIR BLOK KODE BARU ðŸ‘† --}}
        <p class="post-meta">{{formatDate this.createdAt}}</p>

        {{!-- Tampilkan teks postingan jika ada --}}
        {{#if this.content}}
          <p class="post-content" style="margin-bottom: 0px;">{{this.content}}</p>
        {{/if}}

        {{!-- TAMPILKAN MEDIA JIKA ADA (MVP v2.3) --}}
        {{#if this.photo}} {{!-- Cek apakah object photo tersedia --}}
          <div class="post-media-container" style="margin-top: 8px;">
            <div class="media-placeholder-icon"><i class="fas fa-camera" style="font-size: 36px; color: #6c757d;"></i></div> {{!-- Ikon Placeholder --}}
          {{!-- Cek tipe file menggunakan mimeType dari backend --}}
          {{!-- Asumsi helper 'contains' sudah tersedia di backend Handlebars Anda --}}
          {{#if (contains this.photo.mimeType 'video')}}
            <video controls>
              <source src="{{this.photo.path}}" type="{{this.photo.mimeType}}">
              Browser Anda tidak mendukung video tag.
            </video>
          {{else}}
            <img src="{{this.photo.path}}"> {{!-- Pastikan ALT DIHAPUS dan tanpa inline style --}}
          {{/if}}
          </div>
        {{/if}}
        {{!-- AKHIR AREA MEDIA --}}

        

        {{!-- AREA LIKE (MVP v2.1) --}}
  {{#if @root.user}}
  <div class="post-actions" style="margin-top: 16px; display: flex; align-items: center; gap: 10px;">
            {{!-- Logika Kondisional untuk Tombol --}}
            <svg width="0" height="0" style="position:absolute;visibility:hidden;">
              <defs>
                <linearGradient id="heartGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" stop-color="#dc2626" />
                  <stop offset="100%" stop-color="#f87171" />
                </linearGradient>
              </defs>
            </svg>
            {{#if this.isLikedByCurrentUser}}
              <form action="/api/v1/posts/{{this.id}}/unlike" method="POST" style="display:inline;margin:0;">
                <button type="submit" class="btn-unlike" aria-label="Batalkan Suka">
                  <span class="heart-icon">
                    <svg viewBox="0 0 24 24" aria-hidden="true"><path class="heart-gradient-fill" d="M12 21s-1-.55-2.35-1.68C6.4 16.6 4 14.28 4 11.25 4 9 5.79 7 8.05 7c1.54 0 2.78.99 3.45 2.03h.99C13.16 7.99 14.4 7 15.95 7 18.21 7 20 9 20 11.25c0 3.03-2.4 5.35-5.65 8.07C13 20.45 12 21 12 21z"/></svg>
                  </span>
                  <span class="like-count">{{#if this.likesCount}}{{this.likesCount}}{{else}}0{{/if}}</span>
                </button>
              </form>
            {{else}}
              <form action="/api/v1/posts/{{this.id}}/like" method="POST" style="display:inline;margin:0;">
                <button type="submit" class="btn-like" aria-label="Suka">
                  <span class="heart-icon">
                    <svg viewBox="0 0 24 24" aria-hidden="true"><path class="heart-outline" d="M12 21s-1-.55-2.35-1.68C6.4 16.6 4 14.28 4 11.25 4 9 5.79 7 8.05 7c1.54 0 2.78.99 3.45 2.03h.99C13.16 7.99 14.4 7 15.95 7 18.21 7 20 9 20 11.25c0 3.03-2.4 5.35-5.65 8.07C13 20.45 12 21 12 21z"/></svg>
                  </span>
                  <span class="like-count">{{#if this.likesCount}}{{this.likesCount}}{{else}}0{{/if}}</span>
                </button>
              </form>
            {{/if}}
            {{!-- Tombol Toggle Komentar --}}
            <button type="button" class="btn-comment js-comment-toggle" data-post-id="{{this.id}}" aria-label="Tampilkan komentar">
              <span class="comment-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2Z"/></svg>
              </span>
              <span class="comment-count">{{#if this.comments.length}}{{this.comments.length}}{{else}}0{{/if}}</span>
            </button>
            {{!-- Akhir Logika Kondisional --}}
        </div>
        {{/if}}
        {{!-- AKHIR AREA LIKE --}}

        {{!-- AREA KOMENTAR (MVP v2.2) --}}
        {{!-- Tampilkan border hanya jika user login atau ada komentar --}}
        <div class="post-comments js-comments-wrapper" data-post-id="{{this.id}}" style="display:none; margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 15px;">
          {{!-- Form Tambah Komentar Utama --}}
          {{#if @root.user}}
          <form action="/api/v1/posts/{{this.id}}/comments" method="POST" class="comment-form" style="margin-bottom: 15px; display: flex; flex-direction: row; gap: 8px;">
            <input type="hidden" name="postId" value="{{this.id}}">
            <div class="form-group" style="flex-grow: 1; margin-bottom: 0;">
              <input name="content" rows="1" placeholder="Tulis komentar..." required class="input-surface w-full rounded-xl px-3 py-2" style="font-size: 0.9em;" />
            </div>
            <button type="submit" class="btn-accent-sm">Kirim</button>
          </form>
          {{/if}}

          {{!-- Daftar Komentar --}}
          <div class="comment-list">
            {{#if this.comments.length}}
              <h4 class="js-comments-title" style="margin-top: 0; margin-bottom: 10px; font-size: 0.95em;">Komentar:</h4>
              {{!-- Loop Komentar Utama --}}
              {{#each this.comments}}
                <div class="comment-item" data-comment-id="{{this.id}}" style="margin-bottom: 14px; font-size: 0.9em; position: relative;">
                  {{#if (and @root.user (eq this.author.id @root.user.id))}}
                    <button class="comment-menu-btn js-comment-menu-btn" data-comment-id="{{this.id}}" aria-haspopup="true" aria-expanded="false" aria-label="Opsi komentar" style="position:absolute; top:4px; right:4px;">
                      <i class="fas fa-ellipsis-vertical" aria-hidden="true"></i>
                    </button>
                    <div class="comment-menu js-comment-menu" data-comment-id="{{this.id}}" style="display:none;">
                      <button type="button" class="post-menu-item danger js-comment-delete" data-comment-id="{{this.id}}">
                        <i class="fas fa-trash-alt" aria-hidden="true"></i>
                        Hapus komentar
                      </button>
                    </div>
                  {{/if}}
                  <div class="comment-body" style="display:flex; gap:10px; align-items:flex-start;">
                    <div class="avatar avatar-sm flex-shrink-0">
                      {{slice this.author.firstName 0 1}}{{slice this.author.lastName 0 1}}
                    </div>
                    <div class="comment-main" style="flex:1; display:flex; flex-direction:column; gap:4px;">
                      <div class="comment-name" style="font-weight:600;">
                        {{#if this.author}}
                          <a href="/users/{{this.author.id}}/profile" style="color:inherit; text-decoration:none;">{{this.author.firstName}} {{this.author.lastName}}</a>
                        {{else}}Anonim{{/if}}
                      </div>
                      <div class="comment-content" style="line-height:1.4;">{{this.content}}</div>
                      <div class="comment-meta-row" style="display:flex; align-items:center; gap:14px; font-size:0.7rem; color:var(--text-secondary-color);">
                        <span class="comment-date">{{formatDate this.createdAt}}</span>
                        {{#if @root.user}}
                          <button class="btn-reply js-reply-button" data-comment-id="{{this.id}}" style="background:var(--surface-muted); padding:4px 10px; border-radius:9999px; font-size:0.65rem; display:inline-flex; align-items:center; gap:6px;">
                            <i class="fas fa-reply" aria-hidden="true" style="font-size:0.7rem;"></i>
                            Balas
                          </button>
                        {{/if}}
                      </div>
                      {{#if @root.user}}
                        <form action="/api/v1/comments/{{this.id}}/replies" method="POST" class="reply-form" id="reply-form-{{this.id}}" style="display:none; margin-top:6px; flex-direction:row; gap:8px;">
                          <input type="hidden" name="postId" value="{{../id}}">
                          <div class="form-group" style="flex-grow:1; margin-bottom:0;">
                            <input name="content" rows="1" placeholder="Tulis balasan..." required class="input-surface w-full rounded-xl px-3 py-2" style="font-size:0.85em;" />
                          </div>
                          <button type="submit" class="btn-accent-sm">Kirim Balasan</button>
                        </form>
                      {{/if}}
                      {{!-- BALASAN --}}
                      {{#if this.replies.length}}
                        <div class="comment-replies" style="margin-top:10px; display:flex; flex-direction:column; gap:10px;">
                          {{#each this.replies}}
                            <div class="comment-item reply-item" data-comment-id="{{this.id}}" style="position:relative;">
                              {{#if (and @root.user (eq this.author.id @root.user.id))}}
                                <button class="comment-menu-btn js-comment-menu-btn" data-comment-id="{{this.id}}" aria-haspopup="true" aria-expanded="false" aria-label="Opsi balasan" style="position:absolute; top:4px; right:4px;">
                                  <i class="fas fa-ellipsis-vertical" aria-hidden="true"></i>
                                </button>
                                <div class="comment-menu js-comment-menu" data-comment-id="{{this.id}}" style="display:none;">
                                  <button type="button" class="post-menu-item danger js-comment-delete" data-comment-id="{{this.id}}">
                                    <i class="fas fa-trash-alt" aria-hidden="true"></i>
                                    Hapus balasan
                                  </button>
                                </div>
                              {{/if}}
                              <div class="comment-body" style="display:flex; gap:8px; align-items:flex-start;">
                                <div class="avatar avatar-sm flex-shrink-0">{{slice this.author.firstName 0 1}}{{slice this.author.lastName 0 1}}</div>
                                <div class="comment-main" style="flex:1; display:flex; flex-direction:column; gap:4px;">
                                  <div class="comment-name" style="font-weight:600;">
                                    {{#if this.author}}
                                      <a href="/users/{{this.author.id}}/profile" style="color:inherit; text-decoration:none;">{{this.author.firstName}} {{this.author.lastName}}</a>
                                    {{else}}Anonim{{/if}}
                                  </div>
                                  <div class="comment-content" style="line-height:1.4;">{{this.content}}</div>
                                  <div class="comment-meta-row" style="display:flex; align-items:center; gap:14px; font-size:0.7rem; color:var(--text-secondary-color);">
                                    <span class="comment-date">{{formatDate this.createdAt}}</span>
                                  </div>
                                </div>
                              </div>
                            </div>
                          {{/each}}
                        </div>
                      {{/if}}
                    </div>
                  </div>
                </div>
              {{/each}}
            {{/if}} {{!-- Akhir if comments.length --}}
          </div> {{!-- Akhir .comment-list --}}
        </div> {{!-- Akhir .post-comments --}}
        {{!-- AKHIR AREA KOMENTAR --}}

      </div> {{!-- Akhir .card .post-item --}}